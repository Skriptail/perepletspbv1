import{h as a,d as s,c as e,$ as t,m as l,a1 as c,F as o,a3 as i,a0 as n,N as d,u,a6 as r,R as m,V as v}from"./vendor-OkV39SfI.js";import{u as p,V as f,a as _,b as g,c as h,_ as x,d as b,e as y,f as k,g as R,h as C,Q,i as E,j as V}from"./index-D8ZiVHsM.js";import"./vuetify-E21gszqs.js";const j={class:"main-content pa-2 pa-sm-4 fade-in pt-6"},F={class:"mb-6"},q={class:"text-h6 mt-2"},W={class:"stat-card glass-card fade-in",style:{"animation-delay":"0.1s"}},O={class:"stat-value"},z={class:"stat-card glass-card fade-in",style:{"animation-delay":"0.2s"}},L={class:"stat-value"},H={class:"coupon-section mb-8"},M={key:0,class:"mb-4 fade-in coupon-item"},N={class:"coupon-container"},P={class:"coupon-info"},w={class:"coupon-text"},I={class:"coupon-count-inline"},J={key:1,class:"mb-4 fade-in coupon-item"},S={class:"coupon-container"},U={class:"coupon-info"},G={key:2,class:"mb-4 no-coupon-message"},T={key:0,class:"qr-demo glass-card pa-6"},$={key:0,class:"coupon-remaining mt-4"},A={class:"instruction mt-4"},B={key:0,class:"qr-demo glass-card pa-6"},D={class:"instruction mt-4"},K=V(a({__name:"GuestPersonal",setup(a){const V=s(!1),K=s(!1),X=p(),Y=e((()=>X.coupons.findIndex((a=>a.startsWith("WELCOME_"))))),Z=e((()=>X.coupons.filter((a=>!a.startsWith("WELCOME_"))))),aa=e((()=>Z.value.length>0)),sa=e((()=>X.qr_code_coupons.filter(((a,s)=>{var e;return!(null==(e=X.coupons[s])?void 0:e.startsWith("WELCOME_"))})))),ea=e((()=>X.telegram_id&&0!==sa.value.length?JSON.stringify({telegram_id:X.telegram_id,code:sa.value[0]}):null));return(a,s)=>(i(),t(o,null,[l(f,{class:"fill-height pa-0 pa-sm-4 personal-container"},{default:c((()=>[l(g,{justify:"center",class:"fill-height ma-0"},{default:c((()=>[l(h,{cols:"12",md:"8",lg:"6",class:"pa-0 pa-sm-2"},{default:c((()=>[n("div",j,[s[17]||(s[17]=n("div",{class:"mb-4"},[n("img",{src:x,alt:"PEREPLËT",class:"logo"})],-1)),n("div",F,[s[6]||(s[6]=n("h1",{class:"text-h4 gradient-text mb-2"},"Личный кабинет",-1)),n("p",q,d(u(X).name),1)]),l(g,{class:"mb-6"},{default:c((()=>[l(h,{cols:"12",md:"6"},{default:c((()=>[n("div",W,[n("div",O,d(u(X).totalHookahCount),1),s[7]||(s[7]=n("div",{class:"stat-label"},"кальянов выкурено",-1))])])),_:1}),l(h,{cols:"12",md:"6"},{default:c((()=>[n("div",z,[n("div",L,d(u(X).couponCount),1),s[8]||(s[8]=n("div",{class:"stat-label"},"полученных купонов",-1))])])),_:1})])),_:1}),n("div",H,[s[16]||(s[16]=n("h2",{class:"text-h5 gradient-text mb-4"}," Мои купоны ",-1)),aa.value?(i(),t("div",M,[n("div",N,[n("div",P,[l(b,{color:"#FFF100",size:"40",class:"mr-3"},{default:c((()=>s[9]||(s[9]=[m("mdi-ticket-confirmation")]))),_:1}),n("div",w,[n("span",I,d(Z.value.length),1),s[10]||(s[10]=n("span",{class:"coupon-label"},"купон на бесплатный кальян",-1))])]),l(y,{color:"error",class:"activate-voucher",onClick:s[0]||(s[0]=v((a=>V.value=!0),["stop"]))},{default:c((()=>[l(b,null,{default:c((()=>s[11]||(s[11]=[m("mdi-qrcode-scan")]))),_:1})])),_:1})])])):r("",!0),-1!==Y.value?(i(),t("div",J,[n("div",S,[n("div",U,[l(b,{color:"#FFF100",size:"40",class:"mr-3"},{default:c((()=>s[12]||(s[12]=[m("mdi-ticket-confirmation")]))),_:1}),s[13]||(s[13]=n("div",{class:"coupon-text"},[n("span",{class:"coupon-count-inline"},"1"),n("span",{class:"coupon-label"},"купон на скидку 30%")],-1))]),l(y,{color:"error",class:"activate-voucher",onClick:s[1]||(s[1]=v((a=>K.value=!0),["stop"]))},{default:c((()=>[l(b,null,{default:c((()=>s[14]||(s[14]=[m("mdi-qrcode-scan")]))),_:1})])),_:1})])])):-1===Y.value?(i(),t("div",G,s[15]||(s[15]=[n("div",{class:"text-h6 text-medium-emphasis"}," У вас пока нет доступных купонов ",-1),n("div",{class:"text-subtitle-1 text-medium-emphasis"}," Накопите 5 кальянов для получения бесплатного! ",-1)]))):r("",!0)])])])),_:1})])),_:1})])),_:1}),l(_,{modelValue:V.value,"onUpdate:modelValue":s[3]||(s[3]=a=>V.value=a),"max-width":"400",class:"glass-card"},{default:c((()=>[l(k,{class:"glass-card"},{default:c((()=>[l(R,{class:"text-h5 gradient-text text-center pa-4"},{default:c((()=>s[18]||(s[18]=[m(" QR-код купона ")]))),_:1}),l(C,{class:"text-center pa-6"},{default:c((()=>{return[ea.value?(i(),t("div",T,[l(Q,{data:ea.value,size:150,level:"H"},null,8,["data"]),s[19]||(s[19]=n("div",{class:"text-subtitle-1 mt-4"},"Ваш QR-код",-1)),s[20]||(s[20]=n("div",{class:"text-caption text-medium-emphasis mt-2"}," Покажите этот QR-код администратору для получения бесплатного кальяна ",-1)),Z.value.length>1?(i(),t("div",$," У вас еще "+d(Z.value.length-1)+" "+d((a=Z.value.length-1,1===a?"купон":a>=2&&a<=4?"купона":"купонов")),1)):r("",!0)])):r("",!0),n("div",A,[l(b,{color:"info",class:"mr-2"},{default:c((()=>s[21]||(s[21]=[m("mdi-information-outline")]))),_:1}),s[22]||(s[22]=n("span",{class:"text-caption"},"После сканирования QR-кода администратором купон будет автоматически погашен.",-1))])];var a})),_:1}),l(E,{class:"justify-center pb-4"},{default:c((()=>[l(y,{color:"red",variant:"elevated",class:"close-button no-outline",onClick:s[2]||(s[2]=a=>V.value=!1)},{default:c((()=>s[23]||(s[23]=[m(" Закрыть ")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),l(_,{modelValue:K.value,"onUpdate:modelValue":s[5]||(s[5]=a=>K.value=a),"max-width":"400",class:"glass-card"},{default:c((()=>[l(k,{class:"glass-card"},{default:c((()=>[l(R,{class:"text-h5 gradient-text text-center pa-4"},{default:c((()=>s[24]||(s[24]=[m(" QR-код купона на 30% скидку ")]))),_:1}),l(C,{class:"text-center pa-6"},{default:c((()=>[-1!==Y.value?(i(),t("div",B,[l(Q,{data:JSON.stringify({telegram_id:u(X).telegram_id,code:u(X).qr_code_coupons[Y.value]}),size:150,level:"H"},null,8,["data"]),s[25]||(s[25]=n("div",{class:"text-subtitle-1 mt-4"},"Ваш QR-код",-1)),s[26]||(s[26]=n("div",{class:"text-caption text-medium-emphasis mt-2"}," Покажите этот QR-код администратору для получения общей скидки 30% ",-1))])):r("",!0),n("div",D,[l(b,{color:"info",class:"mr-2"},{default:c((()=>s[27]||(s[27]=[m("mdi-information-outline")]))),_:1}),s[28]||(s[28]=n("span",{class:"text-caption"},"После сканирования QR-кода администратором купон будет автоматически погашен.",-1))])])),_:1}),l(E,{class:"justify-center pb-4"},{default:c((()=>[l(y,{color:"red",variant:"elevated",class:"close-button no-outline",onClick:s[4]||(s[4]=a=>K.value=!1)},{default:c((()=>s[29]||(s[29]=[m(" Закрыть ")]))),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64))}}),[["__scopeId","data-v-05ac662f"]]);export{K as default};
